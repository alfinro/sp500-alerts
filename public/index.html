<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#111"/>
  <title>SP500 Alerts</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body style="background:#111;color:#fff;font-family:sans-serif;padding:2rem">
  <h1>ðŸ“ˆ Monitor SP500 & VIX</h1>
  <p>Status: <span id="status">AÈ™tept alerte...</span></p>
  <ul id="alerts"></ul>
  <audio id="sound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }

    const socket = io();
    const alertsEl = document.getElementById('alerts');
    const sound = document.getElementById('sound');

    socket.on('alert', data => {
      const li = document.createElement('li');
      li.textContent = `${data.name}: ${data.change}% Ã®n ${data.period} (${data.time})`;
      alertsEl.prepend(li);
      sound.play().catch(() => {});
      if (Notification.permission === 'granted') {
        new Notification(`${data.name} ALERT`, {
          body: `${data.change}% Ã®n ${data.period}`,
        });
      }
    });

    if (Notification.permission !== 'granted') {
      Notification.requestPermission();
    }
  </script>
</body>
</html>
